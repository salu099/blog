<!DOCTYPE html>


<html lang="zh-tw">
<meta content="c#, vue.js, pagination, mvc, 分頁" name="keywords">

<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
    
  
  <meta name="description" content="近期在學習並使用Vue.js，剛好有做資料分頁的需求，雖說網路上流傳著不少好用元件以及範例程式碼，但因為傻露的需求可能比較特別，老是找不到合意的，故最後就決定自己刻。">
  
  
  <meta name="generator" content="Hugo 0.24.1" />

  <title>Vue自訂分頁-以MVC C#實做 &middot; 小卷的胡言亂語</title>

  
  <meta property="og:language" content="zh-TW"/>
  <meta property="og:site_name" content="Vue自訂分頁-以MVC C#實做"/>  
  <meta property="og:title" content="Vue自訂分頁-以MVC C#實做" />
  <meta property="og:description" content="近期在學習並使用Vue.js，剛好有做資料分頁的需求，雖說網路上流傳著不少好用元件以及範例程式碼，但因為傻露的需求可能比較特別，老是找不到合意的，故最後就決定自己刻。" />
  <meta property="og:type" content="article" />
  <meta property="og:url" content="https://salu099.github.io/blog/2018/12/csharp-mvc-vue-pagination/" />
  
  
  
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pure/0.6.2/pure-min.css">

  <!--[if lte IE 8]>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pure/0.6.2/grids-responsive-old-ie-min.css">
  <![endif]-->
  <!--[if gt IE 8]><!-->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pure/0.6.2/grids-responsive-min.css">
  <!--<![endif]-->

  <!--[if lte IE 8]>
  <link rel="stylesheet" href="https://salu099.github.io/blog/css/side-menu-old-ie.css">
  <![endif]-->
  <!--[if gt IE 8]><!-->
  <link rel="stylesheet" href="https://salu099.github.io/blog/css/side-menu.css">
  <!--<![endif]-->

  <link rel="stylesheet" href="https://salu099.github.io/blog/css/blackburn.css">

  
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css">

  
  <link href="https://fonts.googleapis.com/css?family=Raleway" rel="stylesheet" type="text/css">

  
  

  
  <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.11.0/styles/androidstudio.min.css">
  <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.11.0/highlight.min.js"></script>
  <script>hljs.initHighlightingOnLoad();</script>
  

  

<link rel="shortcut icon" href="https://salu099.github.io/blog/img/favicon_5.ico" type="image/x-icon" />
<link rel="bookmark" href="https://salu099.github.io/blog/img/favicon_5.ico"/>


  
  

    
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/1.12.1/jquery.min.js"></script>    
  <link rel="stylesheet" href="https://salu099.github.io/blog/css/menutree/menutree.css" />
  
    
  <script>
  <!--2017/7 add 'go to top' in header.html start-->
  <!--ref: https:
	window.onscroll = function() {scrollFunction()};

	function scrollFunction() {
		if (document.body.scrollTop > 20 || document.documentElement.scrollTop > 20) {
			document.getElementById("myToTopBtn").style.display = "block";
		} else {
			document.getElementById("myToTopBtn").style.display = "none";
		}
	}

	
	function topFunction() {
		document.body.scrollTop = 0;
		document.documentElement.scrollTop = 0;
	}	
	<!--2017/7 add 'go to top' in header.html end-->
	<!--2017/7 add site visitor counter start: change to use histats-->
	
	<!-- $(document).ready(function(){ -->
		<!-- $('a').click(function() { -->
			<!-- if ($(this).hasClass('sociallink')) {}else{ -->
				<!-- $.get("https://script.google.com/macros/s/AKfycbyxudu5idxrDOAUO7QNuEmSq0jljc-5BqjN56h85zlx3Nv9X48/exec", -->
					<!-- function (data) {return false;} -->
				<!-- ); -->
			<!-- } -->
		<!-- }); -->
    <!-- }); -->
	
	
	
	<!-- $.get("https://script.google.com/macros/s/AKfycbxl_kU3_ClDtWRlT22AP3y4hdTxsS7GWxSLuv6gmXuk3sn6p2M/exec", -->
		<!-- function (data) {        			 -->
			<!-- $("#visitornum").html(data); -->
		<!-- } -->
	<!-- ); -->
	<!--2017/7 add site visitor counter end: change to use histats-->
	
	<!--2017/9 add disqus controler button s-->
	<!--https:
	$(document).ready(function() {	
    $('.show-comments').on('click', function(){
          var disqus_shortname = 'salu099'; 

          
          $.ajax({
                  type: "GET",
                  url: "https://" + disqus_shortname + ".disqus.com/embed.js",
                  dataType: "script",
                  cache: true
          });
          
          $(this).fadeOut();
		});		
	});			
	<!--2017/9 add disqus controler button e-->
	
  </script>
  
  <style tyle="text/css">
  @import url(//fonts.googleapis.com/earlyaccess/notosanstc.css);
  .content{font-family: 'Noto Sans TC', sans-serif;}
  </style>
  
  
</head>


<body>

<button onclick="topFunction()" id="myToTopBtn" title="Go to top">TOP</button>


<div id="layout">
  
  
  
  
<a href="#menu" id="menuLink" class="menu-link">
  
  <span></span>
</a>

<div id="menu">

  
    
  
  <div class="avatarcontainer">  
	<div class="divavatar">
		<img src="https://salu099.github.io/blog/img/headimg.png" alt="salu099" style="width:90px;height:90px;" class="avatar">
	</div>  
	<a class="pure-menu-heading brand" href="https://salu099.github.io/blog/">旗津烤小卷/傻露</a>  
	<span>(salu099)</span>
  </div>
    


  <div class="pure-menu">
    <ul class="pure-menu-list">
      
      
        <li class="pure-menu-item">		
          <a class="pure-menu-link" href="https://salu099.github.io/blog/"><i class='fa fa-home fa-fw'></i>首頁</a>
      
        </li>
      
      
        <li class="pure-menu-item">		
          <a class="pure-menu-link" href="https://salu099.github.io/blog/about/"><i class='fa fa-address-card fa-fw'></i>關於我</a>
      
        </li>
      
      
        <li class="pure-menu-item">		
          <a class="pure-menu-link" href="https://salu099.github.io/blog/contact/"><i class='fa fa-pencil-square-o fa-fw'></i>聯絡我</a>
      
        </li>
      
      
        <li class="pure-menu-item">		
          <a class="pure-menu-link" href="https://salu099.github.io/blog/post/"><i class='fa fa-archive fa-fw'></i>文章列表</a>
      
        </li>
      
      
        <li class="pure-menu-item">		
          <a class="pure-menu-link" href="https://salu099.github.io/blog/tags/"><i class='fa fa-tags fa-fw'></i>文章標籤</a>
      
        </li>
      
    </ul>
  </div>
  
  

 
<ul id="tree1">
	<li ><a href="#" style="margin-left:-8px">文章分類</a>
		<ul> 
		
			<li>台灣
				<ul>
													
						
						<li trclass="trhyzone">
						
						<a href="https://salu099.github.io/blog/topics/%E6%92%AE%E3%82%8B"><i class='fa fa-angle-right'></i>撮る</a><span>(0)</span>
						</li>
													
						
						<li trclass="trhyzone">
						
						<a href="https://salu099.github.io/blog/topics/%E9%A3%9F%E3%81%B9%E3%82%8B"><i class='fa fa-angle-right'></i>食べる</a><span>(0)</span>
						</li>
					
				</ul>
			</li>
		
			<li>國外
				<ul>
													
						
						<li trclass="trhyzone">
						
						<a href="https://salu099.github.io/blog/topics/2018%E5%8C%97%E9%99%B8"><i class='fa fa-angle-right'></i>2018北陸</a><span>(0)</span>
						</li>
													
						
						<li trclass="trhyzone">
						
						<a href="https://salu099.github.io/blog/topics/2016%E4%BA%AC%E9%83%BD"><i class='fa fa-angle-right'></i>2016京都</a><span>(0)</span>
						</li>
													
						
						<li trclass="trhyzone">
						
						<a href="https://salu099.github.io/blog/topics/2013%E4%BA%AC%E9%98%AA%E7%A5%9E%E5%A5%88"><i class='fa fa-angle-right'></i>2013京阪神奈</a><span>(0)</span>
						</li>
					
				</ul>
			</li>
			
			<li>隨手記
				<ul>
													
						
						<li trclass="trhyzone">
						
						<a href="https://salu099.github.io/blog/topics/%E7%A8%8B%E5%BC%8F%E7%AD%86%E8%A8%98"><i class='fa fa-angle-right'></i>程式筆記</a><span>(0)</span>
						</li>
													
						
						<li trclass="trhyzone">
						
						<a href="https://salu099.github.io/blog/topics/%E9%83%A8%E8%90%BD%E6%A0%BC%E5%BB%BA%E7%BD%AE"><i class='fa fa-angle-right'></i>部落格建置</a><span>(0)</span>
						</li>
					
				</ul>
			</li>			
			
			
		</ul>
	</li>                
</ul>

<div id="existtopiczone" style="display:none">
	
		
            <li trclass="trhyzone">
                
                <a href="https://salu099.github.io/blog/topics/2013%E4%BA%AC%E9%98%AA%E7%A5%9E%E5%A5%88">
                    2013京阪神奈
                </a>
                <span >(22)</span>
            </li>
        
            <li trclass="trhyzone">
                
                <a href="https://salu099.github.io/blog/topics/2016%E4%BA%AC%E9%83%BD">
                    2016京都
                </a>
                <span >(12)</span>
            </li>
        
            <li trclass="trhyzone">
                
                <a href="https://salu099.github.io/blog/topics/2018%E5%8C%97%E9%99%B8">
                    2018北陸
                </a>
                <span >(3)</span>
            </li>
        
            <li trclass="trhyzone">
                
                <a href="https://salu099.github.io/blog/topics/%E6%92%AE%E3%82%8B">
                    撮る
                </a>
                <span >(53)</span>
            </li>
        
            <li trclass="trhyzone">
                
                <a href="https://salu099.github.io/blog/topics/%E7%A8%8B%E5%BC%8F%E7%AD%86%E8%A8%98">
                    程式筆記
                </a>
                <span >(6)</span>
            </li>
        
            <li trclass="trhyzone">
                
                <a href="https://salu099.github.io/blog/topics/%E9%83%A8%E8%90%BD%E6%A0%BC%E5%BB%BA%E7%BD%AE">
                    部落格建置
                </a>
                <span >(2)</span>
            </li>
        
            <li trclass="trhyzone">
                
                <a href="https://salu099.github.io/blog/topics/%E9%A3%9F%E3%81%B9%E3%82%8B">
                    食べる
                </a>
                <span >(22)</span>
            </li>
        
	
</div>



  <script>
   
	$.fn.extend({
    treed: function (o) {
      
      

      var openedClass = 'fa fa-folder-open icon-lg';
      var closedClass = 'fa fa-folder icon-lg';
      
      if (typeof o != 'undefined'){
        if (typeof o.openedClass != 'undefined'){
        openedClass = o.openedClass;
        }
        if (typeof o.closedClass != 'undefined'){
        closedClass = o.closedClass;
        }
      };
      
        
        var tree = $(this);
        tree.addClass("tree");
        tree.find('li').has("ul").each(function () {
            var branch = $(this); 
            branch.prepend("<i class='indicator glyphicon " + closedClass + "'></i>");
            branch.addClass('branch');
            branch.on('click', function (e) {
                if (this == e.target) {
                    var icon = $(this).children('i:first');
                    icon.toggleClass(openedClass + " " + closedClass);
                    $(this).children().children().toggle();
                }
            })
            branch.children().children().toggle();
        });
        
      tree.find('.branch .indicator').each(function(){
        $(this).on('click', function () {
            $(this).closest('li').click();
        });
      });
        
        tree.find('.branch>a').each(function () {
            $(this).on('click', function (e) {
                $(this).closest('li').click();
                e.preventDefault();
            });
        });
        
        tree.find('.branch>button').each(function () {
            $(this).on('click', function (e) {
                $(this).closest('li').click();
                e.preventDefault();
            });
        });
    }
});


$('#tree1').treed();
 

 






a_group = $('#tree1 li[trclass="trhyzone"]').each(function(){      
    var resultvl = comparison($(this).find('a').text().trim());    
    if(resultvl === ''){
		$(this).children('a').removeAttr('href');	
    }else{      
		$(this).find('span').text(resultvl);    
		$(this).children('a').hover(function() {	
			$(this).addClass("topichyperlink");
		}, function() {
			$(this).removeClass("topichyperlink");
		});
    }
});

 
function comparison(fdname){
	var result = '';
	$('#existtopiczone li[trclass="trhyzone"]').each(function(){         
      if(fdname === $(this).find('a').text().trim()){      	
      	result= $(this).find('span').text().trim();	
      }      
    });
    return result;
}
 

  </script>
  
  
<div class="pure-menu social">
  <ul class="pure-menu-list">

    

    

      

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    
	
	
	
	
    
      
    
    
	
	
	
    <li class="pure-menu-item">
      <a class="pure-menu-link sociallink" href="https://www.behance.net/Sabrina099" target="_blank"><i class="fa fa-behance-square fa-fw"></i>攝影集</a>
    </li>
    	
	
	
    
      
    
    

	
    
      
    
    
	
	
	<li class="pure-menu-item">
		<a class = "pure-menu-link sociallink" href="https://travel98.com/member/90800/article" target="_blank"><i class="fa fa-plane fa-fw" data-fa-transform="rotate-90"></i>Travel98</a>
	</li>
	
	
	
    <li class="pure-menu-item">
	
      
	  <a class="pure-menu-link sociallink" href="https://github.com/salu099" target="_blank"><i class="fa fa-github fa-fw"></i>GitHub</a>
	  
    </li>
    	
	
	
	
	
	    

    

    

    

    

    

    

    

    

    

    

    

    

  </ul>
</div>


  <div>

  
  <div>
    
  </div>
  <div class="small-print">
    
	<a rel="license" href="http://creativecommons.org/licenses/by-nd/4.0/"><img alt="創用 CC 授權條款" style="border-width:0" src="https://i.creativecommons.org/l/by-nd/4.0/80x15.png" /></a><br />本著作係採用<a rel="license" href="http://creativecommons.org/licenses/by-nd/4.0/">創用 CC 姓名標示-禁止改作 4.0 國際 授權條款</a>授權.
  </div>
  
  
  <div class="small-print">
	
    <small id="cpycontent">Salu099 &copy; 2018-#CurrYear#. All rights reserved.</small>	
  </div>
  <div class="small-print">
    
    
	
	<br/><br/>
	
	
	
	<div>
	
	<a href="https://salu099.github.io/blog/" alt="frontpage hit counter" target="_blank" >
	<img  src="//sstatic1.histats.com/0.gif?3898768&101" alt="frontpage hit counter" border="0">
	
	</div>
	
  </div>
</div>

<script>
	
	var replaceyear = function(){
		let content = document.getElementById("cpycontent").innerHTML;
		const year = new Date().getFullYear();
		document.getElementById("cpycontent").innerHTML = content.replace("#CurrYear#",year);
	}()
</script>

    
</div>


  <div id="main">





  
<div class="header" style="background-image:url('https://lh3.googleusercontent.com/-dK7pYxCnhLA/WbKOyKQHqSI/AAAAAAAAWDM/ZLe7yThctmADiH-qrqGfTJn7US4szsluwCHMYBhgL/s1350/banner.jpg');">
  <h1><a style="text-decoration: none;color: #FFF;" href="https://salu099.github.io/blog/">小卷的胡言亂語</a></h1>
  <h2>隨心。隨興。隨喜。隨緣</h2>
  <br/><br/>
</div>  
  
  
  
    

<div class="content">
  
  <h2>Vue自訂分頁-以MVC C#實做</h2>
  
  
  <div class="post-meta">  

  <div>
    <i class="fa fa-calendar fa-fw"></i>
	
    
	    <time>Dec 26, 2018</time>
				
  </div>

  

  
  
  
  <div>
    <i class="fa fa-folder fa-fw"></i>
    			
      <a class="post-taxonomy-topic" href="https://salu099.github.io/blog/topics/%E7%A8%8B%E5%BC%8F%E7%AD%86%E8%A8%98">程式筆記</a>
    
  </div>
  
  

  
  
  
  <div>
    <i class="fa fa-tags fa-fw"></i>
    
      <a class="post-taxonomy-tag" href="https://salu099.github.io/blog/tags/c">c#</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://salu099.github.io/blog/tags/vue.js-2.x">vue.js 2.x</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://salu099.github.io/blog/tags/pagination">pagination</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://salu099.github.io/blog/tags/mvc">mvc</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="https://salu099.github.io/blog/tags/%E5%88%86%E9%A0%81">分頁</a>
    
  </div>
  
    
  
  
  
  <div>
	
  </div>
  
</div>
  
  
  
  
  
  <div id="postcontentzone"><p>近期在學習並使用Vue.js，剛好有做資料分頁的需求，雖說網路上流傳著不少好用元件以及範例程式碼，但因為傻露的需求可能比較特別，老是找不到合意的，故最後就決定自己刻啦。</p>

<p>註：傻露想要的效果類似<a href="http://demos.shieldui.com/web/grid-rows/detail-templates" target="_blank">shield ui醬子</a></p>

<h3 id="使用語言-資源及相關架構">使用語言、資源及相關架構</h3>

<hr />

<p>Vue.js 2.4.2<br />
jQuery 1.9.1<br />
MVC 5(VS2013)<br />
C#<br />
Json.net(不知道第幾版但版號應該沒差)<br />
bootstrap 3.3.7<br />
awesome font 4.7</p>

<h3 id="以下是正文xd">以下是正文XD</h3>

<hr />

<p>設有一群的資料要依分頁顯示，並依照按下分頁時才至資料庫取得該分頁的資料集合。<br />
假設頁碼範圍1-4頁，分頁長像如下：<br />
[|&lt;][&lt;][1][2][3][4][&hellip;][&gt;][&gt;|]</p>

<p>以下就上面所示撰寫範例。</p>

<h4 id="後端">後端</h4>

<p>1.web.config初始化設定<br />
在web.config內設定初始顯示的頁碼、每頁顯示的資料量、以及畫面上要顯示的頁碼範圍(即本例的4頁)</p>

<pre><code class="language-c#=">&lt;configuration&gt;
  &lt;appSettings&gt;  
    &lt;!--取得資料的起始頁數--&gt;
    &lt;add key=&quot;INIPAGE&quot; value=&quot;1&quot;/&gt;
    &lt;!--每頁顯示資料筆數--&gt;
    &lt;add key=&quot;CNT_PAGEITEM&quot; value=&quot;7&quot;/&gt;
    &lt;!--page顯示頁碼集合數--&gt;
    &lt;add key=&quot;CNT_PAGEITEM_MAX&quot; value=&quot;4&quot;/&gt;    
  &lt;/appSettings&gt;
&lt;/configuration&gt;
</code></pre>

<p>2.資料<br />
這邊為了方便起見，不連接資料庫<br />
使用資料來源: <a href="https://www.json-generator.com/api/json/get/cknklDscqG?indent=2">https://www.json-generator.com/api/json/get/cknklDscqG?indent=2</a><br />
以下程式碼因篇幅關係故僅顯示部分資料</p>

<pre><code class="language-c#=">public class SimpleData
{        
    public string GetSimpleData()
    {
        return data;
    }
    private string data = @&quot;[{                               
                                    'index': 0, 
                                    'age': 56,     
                                    'name': 'Flowers Harmon', 
                                    'gender': 'male'
                                 }, 
                                 {
                                    'index': 1, 
                                    'age': 60,     
                                    'name': 'Angie Matthews', 
                                    'gender': 'female'
                                 }, 
                                 {
                                    'index': 2, 
                                    'age': 28,                                     
                                    'name': 'Gina Randolph', 
                                    'gender': 'female'
                                 }]&quot;;
 
}
</code></pre>

<p>3.資料模型<br />
定義顯示的資料model</p>

<pre><code class="language-c#=">public class ModelData
{
    public int index { get; set; }
    public string name { get; set; }
    public int age { get; set; }
    public string gender { get; set; }
    public string TOTPAGE { get; set; }
    public string PAGED { get; set; } 
}
</code></pre>

<p>4.分頁資料模型<br />
定義分頁的資料model</p>

<pre><code class="language-c#=">public class PageData
{
    //pager model
    //往前
    public bool EnableLeft { get; set; }
    //往後
    public bool EnableRight { get; set; }       
    //省略符號(前)
    public bool DisplayLeftEllipsesZone { get; set; }
    //省略符號(後)
    public bool DisplayRightEllipsesZone { get; set; }
    //省略符號index(前)
    public string LeftEllipsIndex { get; set; }
    //省略符號index(後)
    public string RightEllipsIndex { get; set; }
    //顯示頁碼
    public List&lt;string&gt; DisplayPageZone { get; set; }
    //總頁數
    public string TotalPage { get; set; }
    //現在頁數
    public string CurrentPage { get; set; }
    
    public PageData()
    {
        this.EnableLeft = false;
        this.EnableRight = false;
        this.DisplayLeftEllipsesZone = false;
        this.DisplayRightEllipsesZone = false;
        this.LeftEllipsIndex = &quot;1&quot;;
        this.RightEllipsIndex = &quot;1&quot;;
        this.TotalPage = &quot;1&quot;;
        this.CurrentPage = &quot;1&quot;;
        this.DisplayPageZone = new List&lt;string&gt;();            
    }
}
</code></pre>

<p>5.分頁資料邏輯<br />
這部分是參考網友的程式碼，再依據自己的需求調整</p>

<pre><code class="language-c#=">public class CommonTool
{
    /// &lt;summary&gt;
    /// 自訂分頁物件
    /// &lt;/summary&gt;
    /// &lt;param name=&quot;currPage&quot;&gt;所在頁碼&lt;/param&gt;
    /// &lt;param name=&quot;cntPage&quot;&gt;顯示頁碼maxValue(每頁顯示資料量)&lt;/param&gt;
    /// &lt;param name=&quot;totPage&quot;&gt;資料總頁數&lt;/param&gt;
    /// &lt;returns&gt;&lt;/returns&gt;
    public PageData GetDisplayPages(int currPage, int cntPage, int totPage)
    {
        PageData pgdata = new PageData();                                        
        int ppSize = totPage / cntPage;
        if (totPage % cntPage &gt; 0)
            ppSize++;            
        int currppSize = 1;
        if (currPage % cntPage != 0)
            currppSize = (currPage / cntPage) + 1;  
        else            
            currppSize = (currPage / cntPage);                            
        //判斷是否顯示省略符號            
        int pStart = 1;
        if (currPage % cntPage != 0)
            pStart = ((currPage / cntPage) * cntPage + 1); 
        else
            pStart = ((currPage - 1) / cntPage) * cntPage+1;
        int pEnd = pStart + (cntPage - 1);
        if (pEnd &gt; totPage)            
            pEnd = totPage;
        if (currppSize &gt; 1)
        {
            pgdata.DisplayLeftEllipsesZone = true;
            pgdata.LeftEllipsIndex = (pStart - 1).ToString();
        }
        if (currppSize &lt; ppSize)
        {
            pgdata.DisplayRightEllipsesZone = true;
            pgdata.RightEllipsIndex = (pEnd + 1).ToString();
        }                
        //畫面上顯示之頁碼
        for (int i = pStart; i &lt;= pEnd; i++)
        {
            pgdata.DisplayPageZone.Add(i.ToString());
        }
                    
        //首頁末頁
        if (currPage == 1)            
        {
            if (totPage &gt; 1)
                pgdata.EnableRight = true; 
        }                           
        else
        {
            if (currPage == totPage)             
                pgdata.EnableLeft = true;                   
            else
            {
                pgdata.EnableLeft = true;
                pgdata.EnableRight = true;                    
            }
        }
        pgdata.TotalPage = totPage.ToString();
        pgdata.CurrentPage = currPage.ToString();

        return pgdata;
    }
}
</code></pre>

<p>6.撰寫取資料、取得分頁相關設定值的Service</p>

<pre><code class="language-c#=">public class DataService
{
    /// &lt;summary&gt;
    /// 取得資料結果
    /// &lt;/summary&gt;
    /// &lt;param name=&quot;pagnum&quot;&gt;頁碼&lt;/param&gt;
    /// &lt;param name=&quot;pagedata&quot;&gt;每頁資料量&lt;/param&gt;
    /// &lt;returns&gt;&lt;/returns&gt;
    public dynamic GetResult(string pagnum, string pagedata)
    {
        List&lt;ModelData&gt; result = new List&lt;ModelData&gt;();
        List&lt;ModelData&gt; data = JsonConvert.DeserializeObject&lt;List&lt;ModelData&gt;&gt;(new SimpleData().GetSimpleData());
        //計算該筆資料所在頁數
        int i = 0;
        foreach (var t in data)
        {
            i++;
            t.PAGED = Math.Ceiling(Convert.ToDouble(i) / Convert.ToDouble(pagedata)).ToString(); 
        }
        //計算總頁數
        var totpage = Math.Ceiling(Convert.ToDouble(data.Count) / Convert.ToDouble(pagedata));
        result = data.Where(t =&gt; t.PAGED == pagnum.ToString()).ToList();
        result[0].TOTPAGE = totpage.ToString();
            
        return result;
    }
    
    //取得分頁資料結果
    public dynamic GetPager(string currpage, string countpage, string totpage)
    {
        CommonTool tool = new CommonTool();
        return tool.GetDisplayPages(Convert.ToInt32(currpage), Convert.ToInt32(countpage), Convert.ToInt32(Convert.ToDouble(totpage)));
    }
}
</code></pre>

<p>7.HomeController.cs<br />
設定View初始值</p>

<pre><code class="language-c#=">public ActionResult Index()
{
    SetInitial();
    return View();
}
private void SetInitial()
{
    ViewBag.Inipage = System.Configuration.ConfigurationManager.AppSettings[&quot;INIPAGE&quot;].ToString();
    ViewBag.Pageitem = System.Configuration.ConfigurationManager.AppSettings[&quot;CNT_PAGEITEM&quot;].ToString();
    ViewBag.Pagemax = System.Configuration.ConfigurationManager.AppSettings[&quot;CNT_PAGEITEM_MAX&quot;].ToString();
}
</code></pre>

<p>再來增加撰寫取得資料並拋回前端的程式碼</p>

<pre><code class="language-c#=12">DataService service = new DataService();

[HttpPost]
public ActionResult GetData(string pagnum, string pagedata)
{
    string maxnum = System.Configuration.ConfigurationManager.AppSettings[&quot;CNT_PAGEITEM_MAX&quot;].ToString();
    //資料
    var result = service.GetResult(pagnum, pagedata);
    if (result != null)
    {
        //分頁資料
        var PagerData = service.GetPager(pagnum, maxnum, result[0].TOTPAGE);
        return Json(new { rtncode = &quot;1&quot;, rtnmsg = &quot;success&quot;, data = result, pager = PagerData });
    }
    else
        return Json(new { rtncode = &quot;0&quot;, rtnmsg = &quot;failure&quot; });            
}
</code></pre>

<h4 id="前端">前端</h4>

<p>8.Index.cshtml</p>

<pre><code class="language-html=">@{
    ViewBag.Title = &quot;Index&quot;;
}

@Html.Hidden(&quot;getinipage&quot;, (object)ViewBag.Inipage)
@Html.Hidden(&quot;getpageitem&quot;, (object)ViewBag.Pageitem)
@Html.Hidden(&quot;getpagemax&quot;, (object)ViewBag.Pagemax)

&lt;html&gt;
    &lt;head&gt;
        &lt;link rel=&quot;stylesheet&quot; type=&quot;text/css&quot; href=&quot;https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css&quot;&gt;                
        &lt;link rel=&quot;stylesheet&quot; href=&quot;https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css&quot;&gt;
        &lt;link href=&quot;~/Content/styles.css&quot; rel=&quot;stylesheet&quot; /&gt;
    &lt;/head&gt;
    &lt;body&gt;        
        &lt;div id=&quot;app&quot; v-cloak&gt;  
            &lt;table class=&quot;table table-condensed&quot;&gt;
                &lt;tr&gt;
                    &lt;th&gt;#&lt;/th&gt;
                    &lt;th&gt;name&lt;/th&gt;
                    &lt;th&gt;age&lt;/th&gt;
                    &lt;th&gt;gender &lt;/th&gt;
                &lt;/tr&gt;
                &lt;tr v-for=&quot;(r, index) in dataVal&quot;&gt;                    
                    &lt;td&gt;{{ r.index+1 }}&lt;/td&gt;
                    &lt;td&gt;{{ r.name }}&lt;/td&gt;
                    &lt;td&gt;{{ r.age }}&lt;/td&gt;
                    &lt;td&gt;{{ r.gender }}&lt;/td&gt;
                &lt;/tr&gt;
            &lt;/table&gt; 

            &lt;div class=&quot;page-footer&quot;&gt;
                &lt;div class=&quot;container-fluid text-center py-3&quot;&gt;
                    &lt;div class=&quot;row&quot;&gt;
                        @{ Html.RenderPartial(&quot;Partial_Page&quot;);}
                    &lt;/div&gt;
                &lt;/div&gt;                        
            &lt;/div&gt;            

        &lt;/div&gt;

        &lt;script src=&quot;http://code.jquery.com/jquery-1.9.1.js&quot;&gt;&lt;/script&gt;
        &lt;script src=&quot;https://cdnjs.cloudflare.com/ajax/libs/vue/2.4.2/vue.min.js&quot;&gt;&lt;/script&gt;
        &lt;script src=&quot;https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js&quot;&gt;&lt;/script&gt;
        &lt;script src=&quot;~/Scripts/index.js&quot;&gt;&lt;/script&gt;
    &lt;/body&gt;
&lt;/html&gt;
</code></pre>

<p>分頁Partial_Page.cshtml</p>

<pre><code class="language-html=">&lt;div class=&quot;pagination&quot;&gt;
    &lt;ul class=&quot;pagination pagination-sm&quot;&gt;   
        &lt;li class=&quot;page-item&quot; v-bind:class=&quot;[dataPage.EnableLeft ? '' : 'btndisabled']&quot; &gt;        
            &lt;a class=&quot;page-link&quot; href=&quot;#&quot; v-on:click=&quot;setPage(1)&quot; title=&quot;第一頁&quot;&gt;&lt;i class=&quot;fa fa-angle-double-left fa-lg&quot;&gt;&lt;/i&gt;&lt;/a&gt;  
        &lt;/li&gt;
        &lt;li class=&quot;page-item&quot; v-bind:class=&quot;[dataPage.EnableLeft ? '' : 'btndisabled']&quot; &gt;        
            &lt;a class=&quot;page-link&quot; href=&quot;#&quot; v-on:click=&quot;setPage(parseInt(dataPage.CurrentPage)-1)&quot; title=&quot;上一頁&quot;&gt;&lt;i class=&quot;fa fa-angle-left fa-lg&quot; &gt;&lt;/i&gt;&lt;/a&gt;        
        &lt;/li&gt;
        &lt;li class=&quot;page-item&quot;&gt;
            &lt;a class=&quot;page-link&quot; href=&quot;#&quot; v-show=&quot;dataPage.DisplayLeftEllipsesZone&quot; v-on:click=&quot;setPage(dataPage.LeftEllipsIndex)&quot; title=&quot;更多...&quot;&gt;...&lt;/a&gt;
        &lt;/li&gt;
        &lt;li class=&quot;page-item&quot; v-for=&quot;pageNum in dataPage.DisplayPageZone&quot; v-bind:class=&quot;[(parseInt(pageNum) === parseInt(dataPage.CurrentPage)) ? 'active' : '']&quot;&gt;
            &lt;a class=&quot;page-link&quot; href=&quot;#&quot; v-on:click=&quot;setPage(pageNum)&quot; &gt;{{ pageNum }}&lt;/a&gt;
        &lt;/li&gt;   
        &lt;li class=&quot;page-item&quot;&gt;
            &lt;a class=&quot;page-link&quot; href=&quot;#&quot; v-show=&quot;dataPage.DisplayRightEllipsesZone&quot; v-on:click=&quot;setPage(dataPage.RightEllipsIndex)&quot; title=&quot;更多...&quot;&gt;...&lt;/a&gt;
        &lt;/li&gt;
        &lt;li class=&quot;page-item&quot; v-bind:class=&quot;[dataPage.EnableRight ? '' : 'btndisabled']&quot;&gt;
            &lt;a class=&quot;page-link&quot; href=&quot;#&quot; v-on:click=&quot;setPage(parseInt(dataPage.CurrentPage)+1)&quot; title=&quot;下一頁&quot;&gt;&lt;i class=&quot;fa fa-angle-right fa-lg&quot;&gt;&lt;/i&gt;&lt;/a&gt;
        &lt;/li&gt; 
        &lt;li class=&quot;page-item&quot; v-bind:class=&quot;[dataPage.EnableRight ? '' : 'btndisabled']&quot;&gt;
            &lt;a class=&quot;page-link&quot; href=&quot;#&quot; v-on:click=&quot;setPage(dataPage.TotalPage)&quot; title=&quot;最末頁&quot;&gt;&lt;i class=&quot;fa fa-angle-double-right fa-lg&quot; &gt;&lt;/i&gt;&lt;/a&gt;
        &lt;/li&gt;      
    &lt;/ul&gt;
&lt;/div&gt;
</code></pre>

<p>9.分頁css</p>

<pre><code class="language-css=">body {
    padding-top: 70px; 

    /*font-family*/    
    font-family: &quot;Helvetica&quot;, &quot;Arial&quot;,&quot;LiHei Pro&quot;,&quot;黑體-繁&quot;,&quot;微軟正黑體&quot;, sans-serif;
    line-height: 2;
    font-size: 15px;
    font-weight: 300;
}
/*pagination style*/

/*控制首末按鈕disabled*/
.btndisabled a{
    pointer-events: none;
    cursor:not-allowed;
    background-color:#fafafa !important;
    color:#b3b6bc !important;
}

/*覆寫bootstrap*/
.pagination-sm &gt; li &gt; a, .pagination-sm &gt; li &gt; span {
    font-size:15px !important;
    line-height:1 !important;
}
</code></pre>

<p>10.Javascript(index.js)<br />
先撰寫Ajax取得資料</p>

<pre><code class="language-javascript=">//startPageIndex:頁數
//eachPageNum:每頁顯示資料筆數
function GetAll(startPageIndex, eachPageNum)
{
    var serviceURL = '../Home/GetData';

    $.ajax({
        type: 'post',
        contentType: &quot;application/json; charset=utf-8&quot;,
        url: serviceURL,
        data: JSON.stringify({ 'pagnum': startPageIndex, 'pagedata': eachPageNum }),
        dataType: &quot;json&quot;,
        cache: false,
        success: function (Result) {
            if (Result.rtncode === '1') {
                app.dataVal = Result.data;
                app.dataPage = Result.pager;
            }
            else {
                app.dataVal = [];
                app.dataPage = [];
            }            
        },
        error: function () { /*alert(data.d.rtnmsg);*/ }
    });
}
</code></pre>

<p>Ajax取得資料後餵給Vue</p>

<pre><code class="language-javascript=27">$(document).ready(function () {
    //取得後端設定的相關資料
    var startPageIndex = $(&quot;#getinipage&quot;).val();
    var eachPageNum = $(&quot;#getpageitem&quot;).val();
    //取資料
    GetAll(startPageIndex, eachPageNum);
});

var app = 
    new Vue({
            el: '#app',
            data: {
                dataVal: [],
                dataPage: []
            },
            methods: {
                setPage: function (page) {
                    var eachPageNum = $(&quot;#getpageitem&quot;).val();
                    GetAll(page, eachPageNum);
                }
            }
        });
</code></pre>

<p>這樣就完成分頁啦，後來因重複使用需要，傻露也改寫成component，下回有機會再分享囉~。</p>

<h2 id="參考資料">參考資料</h2>

<p><a href="https://dotblogs.com.tw/shadow/archive/2013/05/09/103351.aspx" target="_blank">[ASP.net MVC 4] 自己打造分頁Pager範例程式碼 (數字版，Ajax)</a><br />
<a href="https://cn.vuejs.org/v2/guide/installation.html" target="_blank">Vue Document</a></p></div>
  
  
  <br/>
  <div>
	<iframe src='' scrolling='no' frameborder='0' style='width:150px; height:20px;' allowTransparency='true' onload='this.src="https://www.facebook.com/plugins/like.php?locale=zh_TW&amp;href=https://" + location.hostname + location.pathname + "&amp;layout=button_count&amp;action=like&amp;colorscheme=light&amp;share=true"; this.onload="";'></iframe>		
	<div class='g-plusone' data-size='medium'></div>
	
  </div>
  <br/>
  
  
<div class="prev-next-post pure-g">
  <div class="pure-u-1-24" style="text-align: left;">
    
    <a href="https://salu099.github.io/blog/2018/09/taiwan-photo-hsinbekeelong-nightspot/"><i class="fa fa-chevron-left"></i></a>
    
  </div>
  <div class="pure-u-10-24">
    
    <nav class="prev">
      <a href="https://salu099.github.io/blog/2018/09/taiwan-photo-hsinbekeelong-nightspot/">夜景系列文三＊新北、基隆夜景賞、攝點</a>
    </nav>
    
  </div>
  <div class="pure-u-2-24">
    &nbsp;
  </div>
  <div class="pure-u-10-24">
    
    <nav class="next">
      <a href="https://salu099.github.io/blog/2018/12/csharp-mvc-vue-component-pagination/">Vue使用Componet自訂分頁-以MVC C#實做</a>
    </nav>
    
  </div>
  <div class="pure-u-1-24" style="text-align: right;">
    
    <a href="https://salu099.github.io/blog/2018/12/csharp-mvc-vue-component-pagination/"><i class="fa fa-chevron-right"></i></a>
    
  </div>
</div>



  

<br/>
<div id="disqusbtn"><button class="show-comments" >留言</button></div>
<br/>

<div id="disqus_thread"></div>





    
    
    
        

    
    
    
    







</div>

</div>
</div>
<script src="https://salu099.github.io/blog/js/ui.js"></script>


<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-106389797-1', 'auto');
  ga('send', 'pageview');

</script>



</body>
</html>

